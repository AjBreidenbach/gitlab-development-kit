#!/bin/sh
GITPOD_WORKSPACE_IMAGE_CURRENT="${GITPOD_WORKSPACE_IMAGE:-gitpod-image}"
GITPOD_WORKSPACE_IMAGE_STABLE="${GITPOD_WORKSPACE_IMAGE_BASE:-gitpod-image}:stable"

docker pull "${GITPOD_WORKSPACE_IMAGE_CURRENT}"
docker tag "${GITPOD_WORKSPACE_IMAGE_CURRENT}" "${GITPOD_WORKSPACE_IMAGE_STABLE}"

if [ "$CI" = "true" ]; then
  docker push "${GITPOD_WORKSPACE_IMAGE_STABLE}"
fi
