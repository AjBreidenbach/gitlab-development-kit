#!/usr/bin/env ruby

MINIMAL_VERSION = "1.12"

version_output = ""

begin
  version_output = `go version`
rescue Errno::ENOENT
  abort "Go is not installed, please install Go #{MINIMAL_VERSION} or higher"
end

abort 'Could not determine version of Go' unless $?.success?

expected = Gem::Version.new(MINIMAL_VERSION)
actual = Gem::Version.new(version_output[/go((\d+.\d+)(.\d+)?)/, 1])

case actual <=> expected
when -1
  abort "We've detected that you are using Go version #{actual}.\n Please install Go version #{MINIMAL_VERSION} or higher"
when nil
  abort "Unable to determine version of Go"
end
