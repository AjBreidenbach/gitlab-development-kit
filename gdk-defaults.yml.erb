# This file contains the defaults for GDK
# It is a YAML file, but it will be processed as ERB first

repositories:
  gitlab: https://gitlab.com/gitlab-org/gitlab-ce.git
  gitlab_shell: https://gitlab.com/gitlab-org/gitlab-shell.git
  gitlab_workhorse: https://gitlab.com/gitlab-org/gitlab-workhorse.git
  gitaly: https://gitlab.com/gitlab-org/gitaly.git
  gitaly_proto: https://gitlab.com/gitlab-org/gitaly-proto.git
  gitlab_pages: https://gitlab.com/gitlab-org/gitlab-pages.git
  gitlab_docs: https://gitlab.com/gitlab-com/gitlab-docs.git

gdk_root: <%= cmd!('pwd') %>
#<% if config.auto_devops.enabled %>
hostname: <%= "#{config.auto_devops.gitlab.port}.qa-tunnel.gitlab.info" %>
port: 443
https: true
#<% else %>
hostname: <%= read!('hostname') || 'localhost' %>
port: <%= read!('port') || 3000 %>
https: <%= read!('https_enabled') || false %>
#<% end %>

relative_url_root: <%= read!('relative_url_root') || nil %>
username: <%= cmd!('whoami') %>

webpack:
  port: <%= read!('webpack_port') || 3808 %>

registry:
#<% if config.auto_devops.enabled %>
  enabled: true
  host: <%= "#{config.auto_devops.registry.port}.qa-tunnel.gitlab.info" %>
  port: <%= config.auto_devops.registry.port %>
  external_port: 443
#<% else %>
  enabled: <%= read!('registry_enabled') || false %>
  host: 127.0.0.1
  port: <%= read!('registry_port') || 5000 %>
  external_port: 5000
#<% end %>

object_store:
  enabled: <%= read!('object_store_enabled') || false %>
  port: <%= read!('object_store_port') || 9000 %>

gitlab_pages:
  enabled: true
  port: <%= read!('gitlab_pages_port') || 3010 %>

auto_devops:
  enabled: <%= read!('auto_devops_enabled') || false %>
  gitlab:
    port: <%= read_or_write!('auto_devops_gitlab_port', rand(20000..24999)) %>
  registry:
    port: <%= read!('auto_devops_registry_port') || (config.auto_devops.gitlab.port.to_i + 5000) %>

geo:
  enabled: false

elasticsearch:
  version: 6.5.1
  checksum: 5903e1913a7c96aad96a8227517c40490825f672

tracer:
  build_tags: tracer_static tracer_static_jaeger
  jaeger:
    enabled: true
    version: 1.10.1

nginx:
  enabled: false
  bin: <%= cmd!('which nginx') %>
  workhorse_port: 3333

postgresql:
  bin_dir: <%= cmd!('support/pg_bindir') %>
  replication_user: gitlab_replication
  dir: <%= config.gdk_root %>/postgresql
  data_dir: <%= config.postgresql.dir %>/data
  replica_dir: <%= config.gdk_root %>/postgresql-replica
  geo_dir: <%= config.gdk_root %>/postgresql-geo

gitaly:
  assembly_dir: <%= config.gdk_root %>/gitaly/assembly

sshd:
  bin: <%= cmd!('which sshd') %>

git:
  bin: <%= cmd!('which git') %>
